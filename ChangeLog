2007-02-26 Pierangelo Masarati <masarati@aero.polimi.i>

	* RTAI 3.5 release

2007-02-25  Roberto Bucher <roberto.bucher@supsi.ch>

	*/rtai-lab/scilab/macros/RTAI/:RTAICodegen_.sci: Some changes to
	run under Windows

2007-02-09  Roberto Bucher <roberto.bucher@supsi.ch>

	* /rtai-lab/scilab/macros/RTAI/SetTarget_.sci,
	*/rtai-lab/scilab/macros/RTAI/:RTAICodegen_.sci: Corrected bug with 
	non existent TARGET_DIR (again!).
	*/rtai-lab/scilab/macros/RTAI/:RTAICodegen_.sci: Eliminated the string
	substitution '-' -> '_' for the generation folder.


2007-01-19  Roberto Bucher <roberto.bucher@supsi.ch>

	* /rtai-lab/scilab/macros/RTAI/SetTarget_.sci,
	*/rtai-lab/scilab/macros/RTAI/:RTAICodegen_.sci: Corrected bug with 
	non existent TARGET_DIR.

2007-01-11  Roberto Bucher <roberto.bucher@supsi.ch>

	* /rtai-lab/scilab/rtmain.c,
	*/rtai-lab/matlab/rtmain.c:  rt_rpc replaces rt_send+rt_task_suspend
	in the rtBaseRate procedure.

2007-01-11  Paolo Mantegazza <mantegazza@aero.polimi.it>

	* base/sched/sched.c: lxrt_intercept_schedule_tail needs not to return
	  anything, typed void.

2007-01-10  Paolo Mantegazza <mantegazza@aero.polimi.it>
            Roberto Bucher <roberto.bucher@supsi.ch>

	* base/sched/sched.c: avoid suspends only if the task owns resource
	  semaphores, before it did not suspend if sent messages were pending
	  also.

2007-01-05  Paolo Mantegazza <mantegazza@aero.polimi.it>

	* base/sched/sched.c: recast a, forgotten, dynamic link to 
	  rt_sem_signal to support Linux REGPARM.

2007-01-04  Paolo Mantegazza <mantegazza@aero.polimi.it>

	* base/include/rtai_netrpc.h: safer support of receive buffer sizes
	  in user space asynchronous support (rt_get_net_rpc_ret).
	* base/ipc/netrpc.c: get rid of unused/redundant stuff in local 
	  mbx support for asynchronous returns.

2007-01-03  Paolo Mantegazza <mantegazza@aero.polimi.it>

	* base/include/rtai_tbx.h and 
	  base/ipc/tbx/tbx.c: fixed missing support for Linux REGPARM of 
	  broadcasting functions.
	* base/ipc/mq/mq.c: use mq_curmsgs as an index in get/freeing nodes, 
	  nodind is redundant; simplify a few tests.
	* base/include/rtai_mq.h: get rid of redundant variable nodind.

2007-01-02  Paolo Mantegazza <mantegazza@aero.polimi.it>

	* base/ipc/mq/mq.c: msgsize checked without any lock, fixed queue 
	  head resetting in receiving functions, ensured queue mutex is 
	  unlocked always.
	* base/sched/sched.c: do not execute Linux syscalls internally if a 
	  signal is pending.

2006-12-29  Pierangelo Masarati <masarati@aero.polimi.it>

	* cleanup of configure
	* preparation for 3.5 release

2006-12-28  Paolo Mantegazza <mantegazza@aero.polimi.it>

	* base/sched/sched.c: cleaned and reworked Linux syscalls prologue.

2006-12-27  Paolo Mantegazza <mantegazza@aero.polimi.it>

	* base/include/rtai_sched.h,
	* base/include/rtai_schedcore.h,
	* base/sched/api.c,
	* base/sched/sched.c, get rid and clean up of RT_SCHED_SELFSUSP state
	  stuff, used no more.
	* base/sched/sched.c: reworked sched locking to set/reset
	  rt_scheduling.rqsted more appropriately.

2006-12-26  Paolo Mantegazza <mantegazza@aero.polimi.it>

	* base/arch/i386/hal/hal.c: fixed spinlocks definition to support
	  TSCs synchronisation for 2.4.xx also.
	* base/arch/i386/hal/hal.immed: ifdef redundant MODULE_LICENCE to
	  avoid complaint with 2.4.xx.

2006-12-20  Emanuele Clerici <clerici@aero.polimi.it>

	* base/ipc/netrpc/Makefile.kbuild: include path to rtdm.
	* base/ipc/netrpc/rtnetP.h: cancel declaration not needed anymore,
	  because of the use of rtdm.h.
	* base/ipc/netrpc/netrpc.c: include rtdm.h.

2006-12-19  Emanuele Clerici <clerici@aero.polimi.it>

	* base/ipc/netrpc/README: inform users about hard constraints imposed 
	  by using RTNet.
	* base/ipc/netrpc/rtnetP.h: updated call prototypes to the latest 
	  RTNet, to be used since COMPILE_ANYHOW is forced anyhow.
	* base/ipc/netrpc/netrpc.c: updated to satisfy hard constraints imposed
          by using RTNet.

2006-12-18  Roberto Bucher <roberto.bucher@supsi.ch>

	* /rtai-lab/scilab/macros/RTAI/rtai_fifo.sci: Added for 
	compatibility with old versions.

2006-12-18  Paolo Mantegazza <mantegazza@aero.polimi.it>

	* base/include/rtai_tasklets.h, base/include/rtai_wd.h,
	  base/include/rtai_signal.h,
	  base/tasklets/tasklets.c, base/tasklets/signal.c,
          base/wd/wd.c: all changed to allow using Linux with REGPARM enabled.
	* base/include/rtai_schedcore and base/sched/sched.c: try to avoid
	  useless reschedules when changing the priority of a ready task.

2006-12-18 RTAI-3.5 release cycle begins.

2006-12-17  Roberto Bucher <roberto.bucher@supsi.ch>

	* /rtai-lab/scilab/devices/olddevices.c: extract the COMEDI functions.
	* /rtai-lab/scilab/devices/old_comedi.c: Compatibility with old version 
	  for comedi functions.

2006-12-17  Paolo Mantegazza <mantegazza@aero.polimi.it>

	* base/arch/i386/hal/hal.immed: added user space specific code for
	  pending linux irqs (usr_rt_pend_linux_irq).

2006-12-17  Roberto Bucher <roberto.bucher@supsi.ch>

	* /rtai-lab/scilab/devices/rtai_fifoin.c: Added block for FIFO input.
	* /rtai-lab/scilab/macros/RTAI/rtai_fifoin.sci: Added block for FIFO 
	  input.
	* /rtai-lab/scilab/devices/rtai_fifoout.c: Added block for FIFO output.
	* /rtai-lab/scilab/macros/RTAI/rtai_fifoout.sci: Added block for FIFO 
	  output.
	* /rtai-lab/scilab/macros/RTAI/RTAI-Lib.cosf: Modified Scicos Palette.

2006-12-17  Roberto Bucher <roberto.bucher@supsi.ch>

	* /rtai-lab/matlab/rtmain.c: Changed the macro TASKPERIOD
	to TASKDURATION. This feature can be activated by adding
	-DTASKDURATION in the generated Makefile. A variable called
	RTTSKper can read in a S-Function and sent to the output.

2006-12-17  Roberto Bucher <roberto.bucher@supsi.ch>

	* /rtai-lab/scilab/rtmain.c: Changed the macro TASKPERIOD
	to TASKDURATION. This feature can be activated by adding
	-DTASKDURATION in the generated Makefile. A variable called
	RTTSKper can read in a Scicos block and sent to the output.

2006-12-17  Roberto Bucher <roberto.bucher@supsi.ch>

	* /rtai-lab/scilab/macros/RTAI/RT_templates: renamed
	stdalone.cmd to standalone.cmd.

2006-11-17  Roberto Bucher <roberto.bucher@supsi.ch>

	* /rtai-lab/scilab/macros/RTAI/RTAICodeGen_.sci: Added the 
	possibility have the target files in a local directory (to be 
	specified as TARGET_DIR in the .scilab file.

2006-12-16  Paolo Mantegazza <mantegazza@aero.polimi.it>

        * base/sched/sched.c: set is_hard for an RTAI task being stolen from
          Linux before calling schedule, simplified fast_schedule.

2006-12-15  Pierangelo Masarati <masarati@aero.polimi.it>

        * add support to keep Linux task priority aligned to RTAI, structure
          the new way for setting RTNet availability, do not halt making RTAI
          when LINUX REGPARM is set, RTAI supports it now.

2006-12-14  Paolo Mantegazza <mantegazza@aero.polimi.it>

        * base/arch/i386/Kconfig: define the new way for setting RTNet
          availability.
        * base/ipec/netrpc/netrpc.c: use properly the new way of defining
          RTNet availability.

2006-12-13  Paolo Mantegazza <mantegazza@aero.polimi.it>

        * base/sched/sched.c: simplified Linux schedule tail, it can be called
          just within Linux so let's avoiding a useless test.

2006-12-10  Paolo Mantegazza <mantegazza@aero.polimi.it>

        * addons/drivers/serial/rtai_serial.h, addons/drivers/serial/serial.c,
          addons/rtdm/module.c;
        * base/include/rtai_bits.h, base/include/rtai_fifos.h,
          base/include/rtai_mbx.h base/include/rtai_mq.h,
          base/include/rtai_msg.h, base/include/rtai_netrpc.h,
          base/include/rtai_proxies.h, base/include/rtai_registry.h,
          base/include/rtai_rwl.h, base/include/rtai_sched.h,
          base/include/rtai_schedcore.h, base/include/rtai_sem.h,
          base/include/rtai_shm.h, base/include/rtai_spl.h,
          base/include/rtai_tbx.h;
        * base/include/asm-i386/rtai_hal.h;
        * base/ipc/bits/bits.c, base/ipc/fifos/fifos.c, base/ipc/mbx/mbx.c,
          base/ipc/mq/mq.c, base/ipc/msg/msg.c, base/ipc/netrpc/netrpc.c,
          base/ipc/sem/sem.c, base/ipc/shm/shm.c base/ipc/tbx/tbx.c;
        * base/sched/api.c base/sched/sched.c base/sched/sys.c:
          all of the aboves changed to allow using Linux with REGPARM enabled.
2006-12-09  Paolo Mantegazza <mantegazza@aero.polimi.it>

        * base/include/asm-i386/rtai_hal.h and
          base/arch/i386/hal.immed: wipe unused legacy code related to
          UNWRAPPED_CATCH_EVENT away.
        * base/sched/sched.c: use a more meaningful klist name for going hard,
          wipe unused legacy code related to UNWRAPPED_CATCH_EVENT away.

2006-12-07  Paolo Mantegazza <mantegazza@aero.polimi.it>

        * base/sched/sched.c: reset soft level priorities in give_back_to_linux,          simplify enqueuing of ready soft task on the ready list.
        * base/sched/sys.c: avoid a double test by duplicating a single line
          in rtai_lxrt_invoke.

2006-12-06  Paolo Mantegazza <mantegazza@aero.polimi.it>

        * base/arch/i386/Kconfig: add configurable parameter to enable keeping
          soft real time linux tasks priority aligne to RTAI.
        * base/sched/sched.c: add code to support what above.

2006-12-05  Paolo Mantegazza <mantegazza@aero.polimi.it>

        * base/sched/sched.c: added support for getting linux tasks tid,
          i.e. the unique one.

        * base/include/rtai_posix.h, base/include/rtai_lxrt.h: added RTAI
          own functions for getting linux tasks tid.

        * base/include/asm-i386/rtai_hal: make hard irq bit state tests
          visible everywhere, make linux irq request neutral with respect
          to kernel changes, it is up to the user to use the right prototype.

        * base/arch/i386/hal/hal.immed.c: changes to comply to the latest
          hal patches and Linux release (2.6.19).

2006-12-04  Paolo Mantegazza <mantegazza@aero.polimi.it>

        * base/ipc/bits/bits.c, base/ipc/netrpc/netrpc.c, base/ipc/sys/sys.c:
          base/include/rtai.h, base/include/rtai_wrappers.h: avoid inclusion
          of linux/config.h, dismissed in 2.6.19, checked it gives no problem
          down to 2.4.33.

        * base/include/rtai_sem.h: fix a name conflict introduced by
          Linux 2.6.19 (rt_mutex_init).

        * base/include/rtai_hal_names.h: comply to name changes in hal patches
          (from 2.6.19).

        * base/ipc/fifos/fifos.c, base/ipc/shm/shm.c: avoid inclusion of
          linux/devfs_fs_kernel.h and linux/config.h, dismissed in 2.6.19,
          checked down to 2.4.33.

2006-11-30  Paolo Mantegazza <mantegazza@aero.polimi.it>

	* /base/include/asm-i386/rtai_hal.h and
	* /base/include/rtai_hal_names.h: modified to allow using latest hal 
	  patches, even if they are not contained in Vulcano yet.

2006-11-22  Emanuele Monari <emonari@system-group.it>

	* /base/ipc/msg/msg.c: fixes incongruences in documentation.

2006-11-20  Paul Corner <paul_c@tuxcnc.org>

        * /base/scripts/rtai-load.in: use INT in place of SIGINT, should be
          more general and portable.

2006-11-10  Paolo Mantegazza <mantegazza@aero.polimi.it>

        * /base/ipc/netrpc.c: do label current (current->comm) if the hard
          stub is an RTAI own kernel task.

2006-11-09  Paulo Stein <stein@cepel.br>

        * /base/include/rtai_posix.h: for kernel space: fixed an improper
          use of "pshared" in sem_init and redefined a lost MAX_PRIO macro
          again.

2006-11-08  Paolo Mantegazza <mantegazza@aero.polimi.it>

        * /addons/rtdm/module.c: added smp_mb() at the end of
          xnintr_synchronize to avoid computer locks at irq
          detach when shared irqs are enabled.

2006-11-07  Paolo Mantegazza <mantegazza@aero.polimi.it>

        * /include/rtai_sched.h: extended error codes to include netrpc timeout.
2006-11-07  Pierangelo Masarati <masarati@aero.polimi.it>

        * configure.in: allow to configure RTAI_DIAG_TSC_SYNC,
          RTAI_MASTER_TSC_CPU and RTAI_TUNE_TSC_SYNC

2006-11-06  Pierangelo Masarati <masarati@aero.polimi.it>

        * configure.in: allow to configure RTAI_RTDM_EDGE_SHIRQ,
          RTAI_RTDM_LEVEL_SHIRQ and RTAI_DEBUG_RTDM;
          refresh of all build files

2006-11-05  Paolo Mantegazza <mantegazza@aero.polimi.it>

        * /addons/rtdm/* and /addons/drivers/16550.c: aligned to the latest.
        * /base/ipc/shm/shm.c: use TSKEXT1, properly restoring it after being
          used, in place of TSKEXT3 for mapping to user space.
        * /base/include/rtai_hal_names.h: added #error check for TSKEXTs, to
          avoid memory leaks in case hal patches change the related sizing;
          reworked hal_schedule_back_root stuff for proper use of "prev", as
          set from within "context_switch".

2006-11-04  Paolo Mantegazza <mantegazza@aero.polimi.it>

        * /base/include/rtai_hal_names.h: check task extensions (through macro
           TSKEXT0) to avoid memory leaks in case of hal patches changing of
           what set in Linux task struct.

2006-11-02  Paolo Mantegazza <mantegazza@aero.polimi.it>

        * /base/arch/i386/hal/hal.immed: use existing hal-linux support for
          changing Linux real time scheduling policy and rt_priority for
          2.6.xx.

2006-11-01  Paolo Mantegazza <mantegazza@aero.polimi.it>

        * /base/include/rtai_hal_names.h,
        * /base/include/asm-i386/rtai_hal.h: adapted to the new definition of
          hal domains through Linux per_cpu stuff.

2006-10-27  Roberto Bucher <roberto.bucher@supsi.ch>

	* /rtai-lab/scilab/devices/*.c: function getstr changed to
	par_getstr (conflict with a Scilab function). Thanks to
	Simone Mannori.

2006-10-26  Roberto Bucher <roberto.bucher@supsi.ch>

	* /rtai-lab/scilab/macros/RTAI/rtai4_comedi_datain.sci: Corrected
	bug by passing block parameters. Thanks to Simone Mannori.

2006-10-20  Roberto Bucher <roberto.bucher@supsi.ch>

	* /rtai-lab/matlab/rtmain.c: Added a hiddean feature to measure the
	task duration using a compiler flag "-DTASKPERIOD=<fifo nr>.

2006-10-20  Roberto Bucher <roberto.bucher@supsi.ch>

	* /rtai-lab/scilab/rtmain.c: Added a hiddean feature to measure the
	task duration using a compiler flag "-DTASKPERIOD=<fifo nr>.

2006-10-05  Paolo Mantegazza <mantegazza@aero.polimi.it>

        * /base/sched/sched.c: do not return hard immediately if a signal is
          pending after a Linux syscall made in hard mode, use the final part
          of Linux return processing by returning -1.

2006-10-03  Roberto Bucher <roberto.bucher@supsi.ch>

	* /rtai-lab/scilab/macros/RTAI/RTAI-Lib.cosf: Corrected the absolute
	  path contained in the palette.

2006-10-03  Roberto Bucher <roberto.bucher@supsi.ch>

	* /rtai-lab/scilab/rtmain.c: Better handling of the Ctrl-C signals 
	  on certain systems.

2006-09-28  Paolo Mantegazza <mantegazza@aero.polimi.it>

	* /base/ipc/sem.c: check broadcasted task handle to keep the lazy
	   atomicity safe.

2006-09-27  Paolo Mantegazza <mantegazza@aero.polimi.it>

	* /base/ipc/fifos.c: fixed atomic rtf_get_if, it called the internal
	  support for rtf_put_if.
	* /base/include/rtai_posix.h: better behaviour when condvars are
	  cancelled asynchronously.

2006-09-26  Paolo Mantegazza <mantegazza@aero.polimi.it>

        * /base/arch/i386/Kconfig: add configuration for TSC diagnose and
          synchronisation.
        * /base/include/asm-i386/rtai_hal.h:
        * /base/arch/i386/hal/hal.c, hal.immed: use confugiration parameters
          for TSC synchronisation.

2006-09-25  Paolo Mantegazza <mantegazza@aero.polimi.it>

        * /base/include/asm-i386/rtai_hal.h:
        * /base/arch/i386/hal/hal.c, hal.immed: diagnose of TSCs offsets,
           though hal proc display, a possible correction already in place.

2006-09-21  Paolo Mantegazza <mantegazza@aero.polimi.it>

	* /base/include/rtai_posix.h: get rid of redundant (with reference to 
	  pthread.h) declarations disturbing recent gccs.

2006-09-19  Paolo Mantegazza <mantegazza@aero.polimi.it>

        * /base/include/rtai_posix.h: push a cleanup function to decrement
          the mated mutex usage count when a waiting condvar is destroyed.

2006-09-18 RTAI-3.4 released.

2006-09-14  Paolo Mantegazza <mantegazza@aero.polimi.it>

	* /base/tasklets/tasklets.c: update the actual time by reading the
	  timer, postpone actual priority assignment when it is sure it will
	  be used (avoids spurious preemptions), do not let the idle sleep 
	  priority to go below the (user assignable) default threshold.

2006-09-12  Mathias Koehrer <mathias_koehrer@arcor.de>
	    Paolo Mantegazza <mantegazza@aero.polimi.it>

	* /base/ipc/sem/sem.c: appropriately test suspension of delation of
	  a task owning a resource semaphore by using the due macro.
	* /base/sched/sched.c: use the due macro to set suspension of delation 
	  of a task owning a resource semaphore.

2006-09-12  Mathias Koehrer <mathias_koehrer@arcor.de>

	* /testsuite/user/preempt/preemt.c.c: use a volatile to suite stricter 
	  optimization needs for gcc-4.1.3.

2006-09-10  Paolo Mantegazza <mantegazza@aero.polimi.it>

	* base/tasklets/tasklets.c: create per cpu timers manager at the 
	  highest priority, but make available the related value as a 
	  module parameter.

2006-09-06  Paolo Mantegazza <mantegazza@aero.polimi.it>

	* base/ipc/mbx/mbx.c: always signal sems on error returns from 
	  mbx_wait and mbx_wait_until, to allow reuse of the mailbox on
	  restarting from signals.

2006-09-03  Paolo Mantegazza <mantegazza@aero.polimi.it>

	* base/ipc/mq/mq.c: modified cond_var usage, with a simpler internal, 
	  there is no need for a true cond_wait behaviour.

2006-09-02  Paolo Mantegazza <mantegazza@aero.polimi.it>

	* base/ipc/sem/sem.c: deleted useless count keeping in cond_wait 
	  functions.
	* base/include/rtai_pmq.h: added to substitute rtai_mq.h to return 
	  error values as required by POSIX.

2006-08-31  Roberto Bucher <roberto.bucher@supsi.ch>
2006-08-31  Paolo Mantegazza <mantegazza@aero.polimi.it>

	* base/ipc/msg/msg.c: fixed a wrong check of proxy address in case 
	  of abnormal return.

2006-08-31  Paolo Mantegazza <mantegazza@aero.polimi.it>

	* base/include/rtai_prinher.h: added macros to ascertain resources 
	  ownership accordingly to the configured priority inheritance mode.
	* base/sched/sched.c, api.c: use due macros to ascertain resuorces 
	  ownership whatever the configured priority inheritance mode.

2006-08-30  Paolo Mantegazza <mantegazza@aero.polimi.it>

	* base/sched/sched.c: do not care Linux priorities when waking up a 
	  SCHED_NORMAL soft real time task, for users doing it on their own.
	* base/sched/api.c, sys.c: ensure that soft priority and policy of a 
	  linux syscall servers are aligned with those of its master.
	* base/sched/api.c: revised rt_change_prio.
	* base/include/rtai_schedcore.h: revised pass_prio.
	  An almost common layout for both of the aboves.

2006-08-29  Paolo Mantegazza <mantegazza@aero.polimi.it>

	* base/sched/sched.c: check priority and base priority independently
	  when setting/recovering soft values in transitioning hard/soft/hard.
	* base/ipc/msg.c: rt_receive_if on blocked send made as its non if
	  conterpart, the priority recovery was missing.

2006-08-28  Paolo Mantegazza <mantegazza@aero.polimi.it>

	* addons/drivers/166550: updated to the latest.
	* addons/rtdm: updated to the latest.

2006-08-27  Paolo Mantegazza <mantegazza@aero.polimi.it>

	* base/ipc/sem/sem.c: ensure priority inheritance also for RES_SEM 
	  of restype RESEM_BINSEM, it was forgotten. 

2006-08-26  Paolo Mantegazza <mantegazza@aero.polimi.it>

	* base/sched/api.c: added function to get priority and base_priority,
	  all at once.
	* base/include/rtai_lxrt.h and rtai_sched.h: added declarations to
	  support what above.

2006-08-25  Paolo Mantegazza <mantegazza@aero.polimi.it>

	* base/sched/sys.c: set the state of a newly RTAI enabled user space 
	  task to 0 in __task_init. Otherwise there could be cases in which 
	  other tasks can infer a wrong status. Discovered so lately likely 
	  because such a condition comes "by nature" if the new task uses 
	  an RTAI service before other tasks interfere with its state. 

2006-08-24  Paolo Mantegazza <mantegazza@aero.polimi.it>

	* addons/rtdm/rtdm_driver.h: make timeout < 0 mean rt_sem_wait_if in
	  _sem_wait_timed.

2006-08-16  Roberto Bucher <roberto.bucher@supsi.ch>

	* rtai-lab/scilab/rtmain.c: Reinserted rt_send
	* rtai-lab/matlab/rtmain.c: Reinserted rt_send

2006-08-14  Paolo Mantegazza <mantegazza@aero.polimi.it>

	* base/include/rtai_posix.h: more posix compliant return in rwloc
	  unlock.
	* base/ipc/sem/sem.c: check semtype, not only owndby, when resetting 
	  prios at wake up in sem_waits; signal wrlock only if owned and 
	  return RTE_EPERM in rt_rwl_unlock if called without anything to do.

2006-08-13  Roberto Bucher <roberto.bucher@supsi.ch>

	* rtai-lab/scilab/rtmain.c: Replaced send/receive for synchronisation
	between rtBaseRate and rtMain with a semaphore (thanks to G. Palli).

2006-08-13  Roberto Bucher <roberto.bucher@supsi.ch>

	* rtai-lab/matlab/rtmain.c: Replaced send/receive for synchronisation
	between rtBaseRate and rtMain with a semaphore (thanks to G. Palli).

2006-08-13  Roberto Bucher <roberto.bucher@supsi.ch>

	* rtai-lab/scilab/: Changed most of the file because of the new Code 
	generator (Universal Code generator) and porting of the Scicos functions 
	from type "2004" to type "4". The new scicos block interfaces have the 
	name rtai4_xxxxxxxx. The old one (rtai_xxxxxx) are still provided for
	compatibility with old block diagrams.

2006-08-12  Paolo Mantegazza <mantegazza@aero.polimi.it>

	* base/include/rtai_posix.h: better enforce cancellation points
	  in sems and conds wait.

2006-08-10  Paolo Mantegazza <mantegazza@aero.polimi.it>

	* base/include/rtai_posix.h: further enhance adherence to the
	  standard for spin locks.

2006-08-07  Paolo Mantegazza <mantegazza@aero.polimi.it>

	* base/sched/sys.c: rework LXRT rwl_init to take into account its
	  type.
	* base/ipc/sem.c: manage "restype" (recursive, ewrrorcheck, normal).
	  Transform rt_rwl_init to rt_typed_rwl_init, to allow typed 
	  rwlockers. Full backward compatibility kept for all.


2006-08-06  Paolo Mantegazza <mantegazza@aero.polimi.it>

	* base/include/rtai_sem.h: add "restype" to the RTAI semaphore
	  structure.
	* base/include/rtai_types.h: add "restype" macros.
	* base/include/rtai_rwl.h: changes declarations and users space call
	  of rt_rwl_init to rt_typed_rwl_init; rt_rwl_init compatibility 
	  kept through a macro.
	* base/include/rtai_posix.h: further enhance adherence to the
	  standard.

2006-08-05  Paolo Mantegazza <mantegazza@aero.polimi.it>

	* base/include/rtai_sched.h,rtai_sem.h,rtai_types.h: macros and 
	  declarations extensions to support non recursive RES_SEMs types 
	  also.

2006-08-04  Paolo Mantegazza <mantegazza@aero.polimi.it>

	* base/include/rtai_posix.h: revised user space posix interface 
	  (see the many tests in showroom).
	* base/ipc/sem.c: fix wrong return value in rt_rwl_delete.
	* base/sched/sys.c: extend use of __task_init to move user space 
	  tasks to a cpus_allowed.

2006-08-01  Paolo Mantegazza <mantegazza@aero.polimi.it>

	* base/ipc/sem.c: do not let unlocking of RES_SEM, either by non 
	  owner or by owner if unlocked already; reset recursion depth only 
	  for RES_SEM in rt_cndmtx_signal; reorder return values in cond_wait 
	  and cond_wait_until.

2006-07-31  Roberto Bucher <roberto.bucher@supsi.ch>

	* rtai-lab/scilab/: Changed most of the file because of the new Code 
	generator (Universal Code generator) and porting of the Scicos functions 
	from type "2004" to type "4". The new scicos block interfaces have the 
	name rtai4_xxxxxxxx. The old one (rtai_xxxxxx) are still provided for
	compatibility with old block diagrams.

2006-07-31  Paolo Mantegazza <mantegazza@aero.polimi.it>

	* base/sched/sys.c: __task_init returns immediately the available 
	  task extension if already set.
	* base/ipc/sem.c: barrier returns mark the unleashing task and 
	  unlished tasks with different values; typed named semphore 
	  initialization tell if it existed already.
	* base/include/rtai_sem.h, rtai_posix.h: declarations of typed named
	  semaphores redifined according to the new prototype.
	* base/include/rtai_sched.h: add permission error definition.

2006-07-23  Paolo Mantegazza <mantegazza@aero.polimi.it>

	* base/include/rtai_posix: added a few APIs related to timing
	  functions to improve plain POSIX compatibility (see posix user 
	  examples in showroom, new sem_clock added also).

2006-07-18  Paolo Mantegazza <mantegazza@aero.polimi.it>

	* base/include/rtai_posix.h: adapted to the new --posix-wrap making,
	  that allows to use standard Posix APIs names for what RTAI supports.

2006-07-17  Pierangelo Masarati <masarati@aero.polimi.it>

	* add --posix-wrap support to rtai-config, so that it is possible to
	  use supported plain Posix APIs names, i.e. without the need of
	  postpending "_rt".
	* add new /base/posix directory and POSIX_WRAPS support file.

2006-07-12  Paolo Mantegazza <mantegazza@aero.polimi.it>

	* base/include/asm/rtai_shm: simplified by avoiding useless 
	  assignements.
	* base/ipc/shm.c: modified mapping of v/k-malloced shared memory to
	  use the latest for > 2.6.14, found in Linux (drivers/media/video).

2006-07-08  Paolo Mantegazza <mantegazza@aero.polimi.it>

	* base/include/rtai_tasklets.h, base/ipc/sem/sem.c, base/sched/api.c:
	  cleaned faky/misleading documentation comments.

2006-07-07  Paolo Mantegazza <mantegazza@aero.polimi.it>

	* base/sched/sched.c: revised all "stop_rt_timer", to remove 
	  forgotten dead code; ensure period is zero in "start_rt_timer"
	  when oneshot mode is assigned at starting the timer.

2006-07-05  Paolo Mantegazza <mantegazza@aero.polimi.it>

	* base/include/asm-i386/rtai_hal.h: declare support structure for
	  interrupts handling here.
	* base/arch/i386/hal/hal.immed and base/sched/api.c: remove redundant 
	  local declarations of support structure for interrupts handling and 
	  use the one defined in arch specific rtai_hal.h.

2006-06-28  Matthijs ten Berge <m.h.tenberge@alumnus.utwente.nl>

	* base/include/rtai_lxrt.h: use vsnprintf in place of vsprintf
	  to guard against possible memory leaks.

2006-06-26 RTAI-3.4-test1 released.

2006-06-23  Paolo Mantegazza <mantegazza@aero.polimi.it>

	* base/include/rtai_schedcore.h: added common support for linux 
	  syscalls from hard real time, according to the setting of the
	  new parameter CONFIG_RTAI_IMMEDIATE_LINUX_SYSCALL.
	* base/include/asm-i386/rtai_lxrt.h: removed i386 specific support 
	  for linux syscalls from hard real time.

2006-06-23  Pierangelo Masarati <masarati@aero.polimi.it>

	* default of RTAI_SCHED_LXRT_NUMSLOTS set to 150
	* added check for syntax compliance of RTAI_RTDM_FD_MAX
	* added configure/Kconfig support for RTAI_IMMEDIATE_LINUX_SYSCALL

2006-06-22  Paolo Mantegazza <mantegazza@aero.polimi.it>

	* base/include/rtai_wrappers.h: added support to use the newer
	module param declarations keeping them conpatible with 2.4.xx.
	* what above propagated to the all files needing it.
	* base/include/asm-i386/rtai_atomic.h: revised for a better
	  consistency.
	* what above propagated to the all files needing it.

2006-06-18  Paolo Mantegazza <mantegazza@aero.polimi.it>

	* base/sched/api.c: ensure full look ahead in finding hashed 
	  names/adres when there are search collisions.

2006-06-17  Paolo Mantegazza <mantegazza@aero.polimi.it>

	* base/include/rtai_hal_names.h: define the fourth task extension, 
	  i.e TSKEXT3.
	* base/ipc/shm.c: use TSKEXT3 to keep the link for mmapping a user 
          space allocated shared memory.

2006-06-16  Pierangelo Masarati <masarati@aero.polimi.it>

	* beginning of RTAI 3.4 release process.

2006-06-15  Paolo Mantegazza <mantegazza@aero.polimi.it>

	* base/ipc/fifos.c: use a module parm to decide if an LXRT extension 
	  should be created or not.

2006-06-11  Paolo Mantegazza <mantegazza@aero.polimi.it>

	* base/sched/api.c: fixed the test to reposition a blocked task in a 
	  prioq after a priority change.

2006-06-10  Paolo Mantegazza <mantegazza@aero.polimi.it>

	* addons/drivers/serial/rtai_serial.h: stricter typing in struct
	  supporting the call to callback function management.

2006-06-09  Paolo Mantegazza <mantegazza@aero.polimi.it>

	* base/sched/sched.c: adjust priorities for RTAI tasks going hard,
	  in steal_from_linux, before they are stolen from Linux.

2006-06-02  Pierangelo Masarati <masarati@aero.polimi.it>

	* added RTDM_FD_MAX as Kconfig parameter

2006-06-01  Pierangelo Masarati <masarati@aero.polimi.it>

	* Cleanup suggested by Paul <paul_c AT tuxcnc DOT org>
	  (mostly GNUmakefile.am install paths; silence warnings;
	  add #!bin/sh to scripts and so).

2006-05-31  Paolo Mantegazza <mantegazza@aero.polimi.it>

	* base/sched/sys.c: safer return to user space of what returned by 
	  rt_gettimeorig.

2006-05-30  Paolo Mantegazza <mantegazza@aero.polimi.it>

	* base/sched/api.c: fixed wrong priority changed, that did not allow
	  less prioritary changes.

2006-05-23  Paolo Mantegazza <mantegazza@aero.polimi.it>

	* addons/rtdm/rtdm_driver.h: fixed wrong test in 
	  rtdm_strncpy_from_user.

2006-05-23  Paolo Mantegazza <mantegazza@aero.polimi.it>

	* testsuite/user/switches/switches.c and 
	* testsuite/kern/switches/switches.c: added taskswitching time 
	  measures for intertask rpc/receive/return.

2006-05-14  Paolo Mantegazza <mantegazza@aero.polimi.it>

	* base/arch/i386/hal/hal.immed: make available module parms for 
	  either printing or not fpu init/trap warnings, default is no.

2006-05-11  Paolo Mantegazza <mantegazza@aero.polimi.it>

	* base/include/rtai_lxrt.h: fixed unused stack allocation when 
	  rt_thread_create, user space only, uses clone.
	* base/arch/i386/Kconfig: present direct vectoring and scheduling 
	  configuration options unconditionally.

2006-05-08  Bernd Gassmann <gassmann@fzi.de>

	* base/sched/sched.c: export switch_time for independent use, but 
	  only if execution time monitoring is configured.

2006-05-08  Roberto Bucher <roberto.bucher@supsi.ch>

	* rtai-lab/scilab/rtmain.c: Fit new xrtailab with automatic Log.

2006-05-07  Roberto Bucher <roberto.bucher@supsi.ch>

	* rtai-lab/matlab/setup.m: Automatically compile the C-Mex S-Function.
	Thanks to Arno and Giampy.

2006-05-05  Bernd Gassmann <gassmann@fzi.de>

	* base/include/rtai_sched.h: add declaration of periodic_resume_time
	  in task structure.
	* base/sched/api.c and sched.c: keep an independent resume time in
	  all functions involved in periodic tasks scheduling.

2006-05-04  Bernd Gassmann <gassmann@fzi.de>

	* base/ipc/sem/sem.c: fix possible deadlock conditions in 
	  rt_rwl_unlock.

2006-05-04  Roberto Bucher <roberto.bucher@supsi.ch>

	* rtai-lab/scilab/devices: request_port substituted by request_port_id 
	  in sem and mbx files.

2006-05-04  Roberto Bucher <roberto.bucher@supsi.ch>

	* rtai-lab/scilab/macros/RTAI/RTAICodeGeneration_.sci: Solved problem
	  with "_" in model name.
	* rtai-lab/scilab/macros/RTAI/rtai_mbx_rcv_if.sci: Changed default 
	  values in parameter dialog.
	* rtai-lab/scilab/macros/RTAI/rtai_mbx_rcv.sci: Changed default values
	  in parameter dialog.
	* rtai-lab/scilab/macros/RTAI/rtai_sem_wait.sci: Changed default values
	  in parameter dialog.

2006-05-01  Paolo Mantegazza <mantegazza@aero.polimi.it>

	* base/include/rtai_schedcore.h: changed test for priority passed 
	  to a task further blocked either on sems or intertask messages.

2006-04-27  Alberto Sechi <albertosechi@libero.it>
	
	* /rtai-lab/Fl_Scope_Window.cpp, /rtai-lab/Fl_Meter_Window.cpp
	  /rtai-lab/Fl_Synch_Window.cpp, /rtai-lab/Fl_Led_Window.cpp, 
	  /rtai-lab/Fl_Params_Manager.cpp: adjusting of windows dimensions
	  after profiles loading
	* /rtai-lab/matlab/rtmain.c: max comedi devices changed to 10

2006-04-27  Paolo Mantegazza <mantegazza@aero.polimi.it>

	* base/arch/i386/hal/hal.immed, rtc.c: no need to use atomic bit 
	  setting on return from interrupt handling/dispatching.
	* base/ipc/mbx/mabx.c: safer direct acquisition of acces semaphores 
	  in all nonblocking send/receive.

2006-04-25  Roberto Bucher <roberto.bucher@supsi.ch>

	* rtai-lab/scilab/devices: request_port_id substituted by request_port 
	  in sem and mbx files.

2006-04-24  Paolo Mantegazza <mantegazza@aero.polimi.it>

	* base/include/rtai_netrpc.h: deleted useless argument from the call 
	  list of named sem/mbx inniting.

2006-04-19  Alberto Sechi <sechi@aero.polimi.it>

	* addons/comedi/rtai_comedi.h, Kcomedi-module.c: added
	  comedi_data_read_delayed() support.

2006-04-18  Pierangelo Masarati <masarati@aero.polimi.it>
	* base/sched/GNUmakefile.am: reworked scheduler build; only
	  build rtai_sched and rtai_lxrt, create symlinks to legacy
	  schedulers.

2006-04-17  Paolo Mantegazza <mantegazza@aero.polimi.it>

	* base/sched/sched.c: reordered the test for searching the next 
	  oneshot firing, to avoid useless searches.

2006-04-15  Paolo Mantegazza <mantegazza@aero.polimi.it>

	* base/include/asm-i386/rtai_hal.h: revised support for switching 
	  back-forth Linux.
	* base/arch/i386/hal/hal.immed, rtc.c: use new switching back-forth 
	  Linux, when Linux locking is set directly from real time interrupts
	  handling;
	* base/sched/sched.c: use new switching back-forth Linux.

2006-04-15  Paolo Mantegazza <mantegazza@aero.polimi.it>

	* addons/rtdm/core.c, core.h, module.c, proc.c: updated to the latest.

2006-04-12  Alberto Sechi  <sechi@aero.polimi.it>

	* base/iarch/i386/calibration/smi-module.c: added missing
	  rthal_smi_disable before return in smi initting.

2006-04-10  Jan Kiszka  <jan.kiszka@web.de>

	* addons/drivers/16550A/16550A.c: Fix leaking lock in 
	  rt_16550_read().

2006-04-10  Paolo Mantegazza <mantegazza@aero.polimi.it>

	* base/arch/i386/hal/hal.immed: deferred scheduling in interrupt
	  handlers (if configured) wraps Linux locking.
	* base/sched/sched.c: do not call rt_schedule if locked in deferred
	  suspend.

2006-04-07  Paolo Mantegazza <mantegazza@aero.polimi.it>

	* drivers/16550A/16550A.c: updated to the latest.
	* rtdm/core.c, rtdm/device.c, rtdm/device.h, rtdm/drvlib.c,
	  rtdm/module.c, rtdm/proc.c, rtdm/rtdm_driver.h, rtdm/xn.h,
	  rtserial.h: updated to the latest.

2006-04-05  Paolo Mantegazza <mantegazza@aero.polimi.it>

	* base/include/rtai_sched.h: added self suspend state.
	* base/sched/api.c: defer non self suspending to the scheduling
	  functions.
	* base/sched/sched.c: care of rescheduling deferred suspends.

2006-03-30  Paolo Mantegazza <mantegazza@aero.polimi.it>

	* base/include/rtai_wd.h: added user space extension declarations.
	* base/wd/wd.c: added entries table for user space.
	* README.LXRT_EXT_IN_USE: added info about the watchdog extension.

2006-03-27  Paolo Mantegazza <mantegazza@aero.polimi.it>

	* base/include/rtai_tasklet.h: care of forcing to soft a hard task
	  initting a tasklet/timer. 
	* base/sched/sys.c: allow NULL for checking soft/hard real time mode 
	  of the current task.

2006-03-22  Paolo Mantegazza <mantegazza@aero.polimi.it>

	* base/arch/i386/hal/hal.immed: allow changing the default irq ack.
	* base/arch/i386/Kconfig: added configuration and helper for the new 
	  error returns of blocking functions.
	* base/include/rtai_bits.h, rtai_msg.h, rtai_sched.h, rtai_sem.h,
	  rtai_schedcore.h: defines and cleanups to support configuring 
	  return errors, chosing between the legacy and new scheme.
	* base/sched/api.c: new configurable error returns and revision of 
	  suspend services.
	* base/sched/sys.c: new configurable error returns and revision of 
	  the LXRT function calls layout.
	* base/sched/sched.c: new configurable error returns support.
	* base/ipc/bits/bits.c, ipc/mbx/mbx.c, ipc/msg/msg.c, ipc/sem/sem.c,
	  ipc/netrpc/netrpc.c, base/ipc/tbx/tbx.c: new configurable error 
	  returns.

2006-03-21  Paolo Mantegazza <mantegazza@aero.polimi.it>

	* base/include-i386/asm/rtai_hal.h: added declarations to support 
	  simple acks for the 8259A PIC.
	* base/arch/i386/hal/hal.immed: added support for simple acks for 
	  the 8259A PIC
	* base/arch/i386/patches/hal-linux-2.6.15-i386-1.2-01.patch, 
	  hal-linux-2.6.14-i386-1.1-02.patch,
	  hal-linux-2.4.32-i386-1.1-01.patch: export i8259 spinlock.

2006-03-20  Jan Kiszka  <kiszka@rts.uni-hannover.de>

	* addons/rtdm/drvlib.c: fixed incongruencies in sleep and sleep_until
	  services.

2006-03-17  Albert Veli A <Albert.Veli@afconsult.com>

	* base/include/rtai_wrappers.h: wrapping macros to support sysfs in
	  RTAI fifos.c
	* base/ipc/fifos/fifos.c: support sysfs to avoid redifining fifos devs
	  at each reboot.

2006-03-17  Roberto Bucher <roberto.bucher@supsi.ch>

	* rtai-lab/*: Introduced some nice new features from Peter Brier.
	* rtai-lab/scilab/*: Substituted the general structure "devstruct" 
	  with a specific struct for each scicos block.

2006-03-07  Paolo Mantegazza <mantegazza@aero.polimi.it>

	* base/include/rtai_prinher.h: inlines to support full priority
	  inheritance and dynamic ceiling.
	* base/include/rtai_sem.h, rtai_sched.h: added queue element for
	  resources queue.
	* base/arch/i386/Kconfig: added parameter to configure either
	  priority inheritance or ceiling.
	* base/sched/sched.c: added res queue initialisations.
	* base/ipc/sem/sem.c: support priority inheritance/ceiling.
	* base/ipc/msg/msg.c: support priority inheritance/ceiling.
	* base/ipc/mbx/mbx.c: revised and semplified.
	* base/ipc/netrpc/netrpc.c: revised the async mbx use as for mbx.c.

2006-02-22  Paolo Mantegazza <mantegazza@aero.polimi.it>

	* base/arch/i386/calibration/calibrate-module.c, calibrate.c and
	  calibrate.h: added in kernel calibration for both RTAI own tasks 
	  and hardened kthreads.
	* base/arch/i386/calibration/runinfo: use ksched always, i.e. the
	  overall RTAI scheduler.

2006-02-21  Paolo Mantegazza <mantegazza@aero.polimi.it>

	* base/include/rtai_sanity.h: gcc-4.x.x is allowed now.
	* base/include/rtai_schedcore.h and base/include/asm-i386/rtai_hal.h:
	  cleared volatiles in inlined functions declaration to avoid gcc-4 
	  warnings.
	* base/include/asm-i386/rtai_lxrt.h: macros for copy_to/from reworked
	  to avoid gcc-4 warnings.
	* base/ipc/fifos/fifos.c, base/ipc/mq/mq.c and base/ipc/msg/msg.c:
	  use copy_from/to macros found in base/include/asm-i386/rtai_lxrt.h 
	  to avoid gcc-4 warnings.

2006-02-19  Paolo Mantegazza <mantegazza@aero.polimi.it>

	* addons/rtdm/drvlib.c and rtdm_drvlib.h: aligned to the latest.

2006-02-17  Paolo Mantegazza <mantegazza@aero.polimi.it>

	* base/sched/sched.c: WAKE_UP_TASKs macro takes care of keeping Linux
	  and RTAI task rt_priority consistently. It affects give_back_to_linux
	  also. For the moment optionally settable with the hidden internal
	  macro: NEW_WAKE_UP_TASKs.

2006-02-11  Paolo Mantegazza <mantegazza@aero.polimi.it>

	* base/include/rtai_tasklets.h and base/tasklets/tasklets.c: added per
	  cpu timers managers and lists for better MP scalability.
	* base/sched/sched.c: force suspension of released kthreads even if 
	  they own resources, this makes them behave as RTAI own kernel tasks.

2006-02-08  Paolo Mantegazza <mantegazza@aero.polimi.it>

	* doc/doxygen/*.dox: everything revised or rewritten.

2006-02-03 RTAI-3.3 released.
