<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>RTAI API: Real-time shadow services.</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.9.1 -->
<div class="qindex">  <form class="search" action="search.php" method="get">
<a class="qindex" href="main.html">Main&nbsp;Page</a> | <a class="qindex" href="modules.html">Modules</a> | <a class="qindex" href="annotated.html">Data&nbsp;Structures</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="functions.html">Data&nbsp;Fields</a> | <a class="qindex" href="globals.html">Globals</a>  | <span class="search"><u>S</u>earch&nbsp;for&nbsp;<input class="search" type="text" name="query" value="" size="20" accesskey="s"/></span></form></div>
<h1>Real-time shadow services.<br>
<small>
[<a class="el" href="group__nucleus.html">Xenomai nucleus.</a>]</small>
</h1><hr><a name="_details"></a><h2>Detailed Description</h2>
Real-time shadow services. 
<p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Files</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">file &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="shadow_8c.html">shadow.c</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Real-time shadow services. <br></td></tr>

<p>
<tr><td colspan="2"><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__shadow.html#ga49">xnshadow_harden</a> (void)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Migrate a Linux task to the RTAI domain.  <a href="#ga49"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__shadow.html#ga50">xnshadow_relax</a> (void)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Switch a shadow thread back to the Linux domain.  <a href="#ga50"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__shadow.html#ga55">xnshadow_map</a> (xnthread_t *thread, pid_t syncpid, int __user *u_syncp)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Create a shadow thread context.  <a href="#ga55"></a><br></td></tr>
</table>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="ga49" doxytag="shadow.c::xnshadow_harden"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void xnshadow_harden           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">void&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Migrate a Linux task to the RTAI domain. 
<p>
<p><b>For internal use only.</b></p>
<p>
This service causes the transition of "current" from the Linux domain to RTAI. This is obtained by asking the gatekeeper to resume the shadow mated with "current" then triggering the rescheduling procedure in the RTAI domain. The shadow will resume in the RTAI domain as returning from schedule().<p>
Environments:<p>
This service can be called from:<p>
<ul>
<li>User-space thread operating in secondary (i.e. relaxed) mode.</li></ul>
<p>
Rescheduling: always. </p>
    </td>
  </tr>
</table>
<a class="anchor" name="ga55" doxytag="shadow.c::xnshadow_map"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void xnshadow_map           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">xnthread_t *&nbsp;</td>
          <td class="mdname" nowrap> <em>thread</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>pid_t&nbsp;</td>
          <td class="mdname" nowrap> <em>syncpid</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int __user *&nbsp;</td>
          <td class="mdname" nowrap> <em>u_syncp</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Create a shadow thread context. 
<p>
<p><b>For internal use only.</b></p>
<p>
This call maps a nucleus thread to the "current" Linux task.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>thread</em>&nbsp;</td><td>The descriptor address of the new shadow thread to be mapped to "current". This descriptor must have been previously initialized by a call to <a class="el" href="group__pod.html#ga25">xnpod_init_thread()</a>.</td></tr>
  </table>
</dl>
<dl compact><dt><b>Warning:</b></dt><dd>The thread must have been set the same magic number (i.e. xnthread_set_magic()) than the one used to register the skin it belongs to. Failing to do so leads to unexpected results.</dd></dl>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>syncpid</em>&nbsp;</td><td>If non-zero, this must be the pid of a Linux task to wake up when the shadow has been initialized. In this case, u_syncp must be valid to, and the new shadow thread is left in a dormant state (XNDORMANT) after its creation, leading to the suspension of "current" in the RTAI domain. Otherwise, the shadow thread is immediately started and "current" exits from this service without being suspended.</td></tr>
    <tr><td valign="top"></td><td valign="top"><em>u_syncp</em>&nbsp;</td><td>If non-zero, this must be a pointer to an integer variable into the caller's address space in user-space which will be used as a semaphore. This semaphore will be posted to wakeup the task identified by pid before "current" is suspended in dormant state by this service. The awaken Linux task is expected to invoke a syscall hat ends up calling xnshadow_start() to finally start the newly created shadow. Passing a null pointer here has the same effect as passing a zero pid argument, and there will be no attempt to wake up any task.</td></tr>
  </table>
</dl>
Environments:<p>
This service can be called from:<p>
<ul>
<li>Regular user-space process.</li></ul>
<p>
Rescheduling: always. </p>
    </td>
  </tr>
</table>
<a class="anchor" name="ga50" doxytag="shadow.c::xnshadow_relax"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void xnshadow_relax           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">void&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Switch a shadow thread back to the Linux domain. 
<p>
<p><b>For internal use only.</b></p>
<p>
This service yields the control of the running shadow back to Linux. This is obtained by suspending the shadow and scheduling a wake up call for the mated user task inside the Linux domain. The Linux task will resume on return from <a class="el" href="group__pod.html#ga60">xnpod_suspend_thread()</a> on behalf of the root thread.<p>
Environments:<p>
This service can be called from:<p>
<ul>
<li>User-space thread operating in primary (i.e. harden) mode.</li></ul>
<p>
Rescheduling: always.<p>
<dl compact><dt><b>Note:</b></dt><dd>"current" is valid here since the shadow runs with the properties of the Linux task. </dd></dl>
</p>
    </td>
  </tr>
</table>
<hr size="1"><address style="align: right;"><small>Generated on Mon Dec 13 09:43:11 2004 for RTAI API by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.3.9.1 </small></address>
</body>
</html>
