<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>RTAI API: rtai-core/include/rtai_usi.h Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.4 -->
<div class="qindex">  <form class="search" action="search.php" method="get">
<a class="qindex" href="main.html">Main&nbsp;Page</a> | <a class="qindex" href="modules.html">Modules</a> | <a class="qindex" href="annotated.html">Data&nbsp;Structures</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="functions.html">Data&nbsp;Fields</a> | <a class="qindex" href="globals.html">Globals</a> | <a class="qindex" href="pages.html">Related&nbsp;Pages</a>  | <span class="search"><u>S</u>earch&nbsp;for&nbsp;<input class="search" type="text" name="query" value="" size="20" accesskey="s"/></span></form></div>
<h1>rtai-core/include/rtai_usi.h</h1><div class="fragment"><pre>00001 <span class="comment">/*</span>
00002 <span class="comment"> * Copyright (C) 1999-2003 Paolo Mantegazza &lt;mantegazza@aero.polimi.it&gt;</span>
00003 <span class="comment"> *</span>
00004 <span class="comment"> * This program is free software; you can redistribute it and/or</span>
00005 <span class="comment"> * modify it under the terms of the GNU General Public License as</span>
00006 <span class="comment"> * published by the Free Software Foundation; either version 2 of the</span>
00007 <span class="comment"> * License, or (at your option) any later version.</span>
00008 <span class="comment"> *</span>
00009 <span class="comment"> * This program is distributed in the hope that it will be useful,</span>
00010 <span class="comment"> * but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
00011 <span class="comment"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
00012 <span class="comment"> * GNU General Public License for more details.</span>
00013 <span class="comment"> *</span>
00014 <span class="comment"> * You should have received a copy of the GNU General Public License</span>
00015 <span class="comment"> * along with this program; if not, write to the Free Software</span>
00016 <span class="comment"> * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA.</span>
00017 <span class="comment"> */</span>
00018 
00019 <span class="preprocessor">#ifndef _RTAI_USI_H</span>
00020 <span class="preprocessor"></span><span class="preprocessor">#define _RTAI_USI_H</span>
00021 <span class="preprocessor"></span>
00022 <span class="preprocessor">#include &lt;rtai_types.h&gt;</span>
00023 
00024 <span class="preprocessor">#define  FUN_USI_LXRT_INDX 3</span>
00025 <span class="preprocessor"></span>
00026 <span class="preprocessor">#define USI_SEM      0</span>
00027 <span class="preprocessor"></span><span class="preprocessor">#define USI_TASKLET  1</span>
00028 <span class="preprocessor"></span>
00029 <span class="preprocessor">#define _REQ_GLB_IRQ             0</span>
00030 <span class="preprocessor"></span><span class="preprocessor">#define _FREE_GLB_IRQ            1</span>
00031 <span class="preprocessor"></span><span class="preprocessor">#define _STARTUP_IRQ             2</span>
00032 <span class="preprocessor"></span><span class="preprocessor">#define _SHUTDOWN_IRQ            3</span>
00033 <span class="preprocessor"></span><span class="preprocessor">#define _ENABLE_IRQ              4</span>
00034 <span class="preprocessor"></span><span class="preprocessor">#define _DISABLE_IRQ             5</span>
00035 <span class="preprocessor"></span><span class="preprocessor">#define _MASK_AND_ACK_IRQ        6</span>
00036 <span class="preprocessor"></span><span class="preprocessor">#define _ACK_IRQ                 7</span>
00037 <span class="preprocessor"></span><span class="preprocessor">#define _UNMASK_IRQ              8</span>
00038 <span class="preprocessor"></span><span class="preprocessor">#define _PEND_LINUX_IRQ          9</span>
00039 <span class="preprocessor"></span><span class="preprocessor">#define _INIT_SPIN_LOCK         10</span>
00040 <span class="preprocessor"></span><span class="preprocessor">#define _SPIN_LOCK              11</span>
00041 <span class="preprocessor"></span><span class="preprocessor">#define _SPIN_UNLOCK            12</span>
00042 <span class="preprocessor"></span><span class="preprocessor">#define _SPIN_LOCK_IRQ          13</span>
00043 <span class="preprocessor"></span><span class="preprocessor">#define _SPIN_UNLOCK_IRQ        14</span>
00044 <span class="preprocessor"></span><span class="preprocessor">#define _SPIN_LOCK_IRQSV        15</span>
00045 <span class="preprocessor"></span><span class="preprocessor">#define _SPIN_UNLOCK_IRQRST     16</span>
00046 <span class="preprocessor"></span><span class="preprocessor">#define _GLB_CLI                17</span>
00047 <span class="preprocessor"></span><span class="preprocessor">#define _GLB_STI                18</span>
00048 <span class="preprocessor"></span><span class="preprocessor">#define _GLB_SVFLAGS_CLI        19</span>
00049 <span class="preprocessor"></span><span class="preprocessor">#define _GLB_SVFLAGS            20</span>
00050 <span class="preprocessor"></span><span class="preprocessor">#define _GLB_RSTFLAGS           21</span>
00051 <span class="preprocessor"></span><span class="preprocessor">#define _CLI                    22</span>
00052 <span class="preprocessor"></span><span class="preprocessor">#define _STI                    23</span>
00053 <span class="preprocessor"></span><span class="preprocessor">#define _SVFLAGS_CLI            24</span>
00054 <span class="preprocessor"></span><span class="preprocessor">#define _SVFLAGS                25</span>
00055 <span class="preprocessor"></span><span class="preprocessor">#define _RSTFLAGS               26</span>
00056 <span class="preprocessor"></span><span class="preprocessor">#define _WAIT_INTR              27</span>
00057 <span class="preprocessor"></span><span class="preprocessor">#define _WAIT_INTR_IF           28</span>
00058 <span class="preprocessor"></span><span class="preprocessor">#define _WAIT_INTR_UNTIL        29</span>
00059 <span class="preprocessor"></span><span class="preprocessor">#define _WAIT_INTR_TIMED        30</span>
00060 <span class="preprocessor"></span>
00061 <span class="preprocessor">#ifdef __KERNEL__</span>
00062 <span class="preprocessor"></span>
00063 <span class="preprocessor">#ifdef CONFIG_RTAI_USI_BUILTIN</span>
00064 <span class="preprocessor"></span><span class="preprocessor">#define USI_INIT_MODULE     usi_init_module</span>
00065 <span class="preprocessor"></span><span class="preprocessor">#define USI_CLEANUP_MODULE  usi_cleanup_module</span>
00066 <span class="preprocessor"></span><span class="preprocessor">#else  </span><span class="comment">/* !CONFIG_RTAI_USI_BUILTIN */</span>
00067 <span class="preprocessor">#define USI_INIT_MODULE     init_module</span>
00068 <span class="preprocessor"></span><span class="preprocessor">#define USI_CLEANUP_MODULE  cleanup_module</span>
00069 <span class="preprocessor"></span><span class="preprocessor">#endif </span><span class="comment">/* CONFIG_RTAI_USI_BUILTIN */</span>
00070 
00071 <span class="preprocessor">#ifdef __cplusplus</span>
00072 <span class="preprocessor"></span><span class="keyword">extern</span> <span class="stringliteral">"C"</span> {
00073 <span class="preprocessor">#endif </span><span class="comment">/* __cplusplus */</span>
00074 
00075 <span class="keywordtype">int</span> USI_INIT_MODULE(<span class="keywordtype">void</span>);
00076 
00077 <span class="keywordtype">void</span> USI_CLEANUP_MODULE(<span class="keywordtype">void</span>);
00078 
00079 <span class="preprocessor">#ifdef __cplusplus</span>
00080 <span class="preprocessor"></span>}
00081 <span class="preprocessor">#endif </span><span class="comment">/* __cplusplus */</span>
00082 
00083 <span class="preprocessor">#else </span><span class="comment">/* !__KERNEL__ */</span>
00084 
00085 <span class="preprocessor">#include &lt;<a class="code" href="rtai__lxrt_8h.html">rtai_lxrt.h</a>&gt;</span>
00086 
00087 <span class="preprocessor">#ifdef __cplusplus</span>
00088 <span class="preprocessor"></span><span class="keyword">extern</span> <span class="stringliteral">"C"</span> {
00089 <span class="preprocessor">#endif </span><span class="comment">/* __cplusplus */</span>
00090 
00091 RTAI_PROTO(<span class="keywordtype">int</span>, rt_expand_handler_data,(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> data, <span class="keywordtype">int</span> *irq))
00092 {
00093         *irq = data &amp; 0xFFFF;
00094         <span class="keywordflow">return</span> (data &amp; 0xFFFF0000) &gt;&gt; 16;
00095 }
00096 
00097 RTAI_PROTO(<span class="keywordtype">int</span>, rt_request_global_irq,(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> irq, <span class="keywordtype">void</span> *hook, <span class="keywordtype">int</span> hooktype))
00098 {
00099         <span class="keyword">struct </span>{ <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> irq; <span class="keywordtype">void</span> *hook; <span class="keywordtype">int</span> hooktype; } arg = { irq, hook, hooktype };
00100         <span class="keywordflow">return</span> rtai_lxrt(FUN_USI_LXRT_INDX, SIZARG, _REQ_GLB_IRQ, &amp;arg).i[LOW];
00101 }
00102  
00103 RTAI_PROTO(<span class="keywordtype">int</span>, rt_free_global_irq,(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> irq))
00104 {
00105         <span class="keyword">struct </span>{ <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> irq; } arg = { irq };
00106         <span class="keywordflow">return</span> rtai_lxrt(FUN_USI_LXRT_INDX, SIZARG, _FREE_GLB_IRQ, &amp;arg).i[LOW];
00107 }
00108  
00109 RTAI_PROTO(<span class="keywordtype">int</span>, rt_startup_irq,(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> irq))
00110 {
00111         <span class="keyword">struct </span>{ <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> irq; } arg = { irq };
00112         <span class="keywordflow">return</span> rtai_lxrt(FUN_USI_LXRT_INDX, SIZARG, _STARTUP_IRQ, &amp;arg).i[LOW];
00113 }
00114  
00115 RTAI_PROTO(<span class="keywordtype">void</span>, rt_shutdown_irq,(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> irq))
00116 {
00117         <span class="keyword">struct </span>{ <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> irq; } arg = { irq };
00118         rtai_lxrt(FUN_USI_LXRT_INDX, SIZARG, _SHUTDOWN_IRQ, &amp;arg);
00119 }
00120  
00121 RTAI_PROTO(<span class="keywordtype">void</span>, rt_enable_irq,(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> irq))
00122 {
00123         <span class="keyword">struct </span>{ <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> irq; } arg = { irq };
00124         rtai_lxrt(FUN_USI_LXRT_INDX, SIZARG, _ENABLE_IRQ, &amp;arg);
00125 }
00126  
00127 RTAI_PROTO(<span class="keywordtype">void</span>, rt_disable_irq,(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> irq))
00128 {
00129         <span class="keyword">struct </span>{ <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> irq; } arg = { irq };
00130         rtai_lxrt(FUN_USI_LXRT_INDX, SIZARG, _DISABLE_IRQ, &amp;arg);
00131 }
00132  
00133 RTAI_PROTO(<span class="keywordtype">void</span>, rt_mask_and_ack_irq,(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> irq))
00134 {
00135         <span class="keyword">struct </span>{ <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> irq; } arg = { irq };
00136         rtai_lxrt(FUN_USI_LXRT_INDX, SIZARG, _MASK_AND_ACK_IRQ, &amp;arg);
00137 }
00138  
00139 RTAI_PROTO(<span class="keywordtype">void</span>, rt_ack_irq,(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> irq))
00140 {
00141         <span class="keyword">struct </span>{ <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> irq; } arg = { irq };
00142         rtai_lxrt(FUN_USI_LXRT_INDX, SIZARG, _ACK_IRQ, &amp;arg);
00143 }
00144  
00145 RTAI_PROTO(<span class="keywordtype">void</span>, rt_unmask_irq,(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> irq))
00146 {
00147         <span class="keyword">struct </span>{ <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> irq; } arg = { irq };
00148         rtai_lxrt(FUN_USI_LXRT_INDX, SIZARG, _UNMASK_IRQ, &amp;arg);
00149 }
00150  
00151 RTAI_PROTO(<span class="keywordtype">void</span>, rt_pend_linux_irq,(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> irq))
00152 {
00153         <span class="keyword">struct </span>{ <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> irq; } arg = { irq };
00154         rtai_lxrt(FUN_USI_LXRT_INDX, SIZARG, _PEND_LINUX_IRQ, &amp;arg);
00155 }
00156  
00157 RTAI_PROTO(<span class="keywordtype">void</span> *, rt_spin_lock_init,(<span class="keywordtype">void</span>))
00158 {
00159         <span class="keyword">struct </span>{ <span class="keywordtype">int</span> dummy; } arg = { 0 };
00160         <span class="keywordflow">return</span> rtai_lxrt(FUN_USI_LXRT_INDX, SIZARG, _INIT_SPIN_LOCK, &amp;arg).v[LOW];
00161 }
00162  
00163 RTAI_PROTO(<span class="keywordtype">void</span>, rt_spin_lock,(<span class="keywordtype">void</span> *lock))
00164 {
00165         <span class="keyword">struct </span>{ <span class="keywordtype">void</span> *lock; } arg = { lock };
00166         rtai_lxrt(FUN_USI_LXRT_INDX, SIZARG, _SPIN_LOCK, &amp;arg);
00167 }
00168  
00169 RTAI_PROTO(<span class="keywordtype">void</span>, rt_spin_unlock,(<span class="keywordtype">void</span> *lock))
00170 {
00171         <span class="keyword">struct </span>{ <span class="keywordtype">void</span> *lock; } arg = { lock };
00172         rtai_lxrt(FUN_USI_LXRT_INDX, SIZARG, _SPIN_UNLOCK, &amp;arg);
00173 }
00174  
00175 RTAI_PROTO(<span class="keywordtype">void</span>, rt_spin_lock_irq,(<span class="keywordtype">void</span> *lock))
00176 {
00177         <span class="keyword">struct </span>{ <span class="keywordtype">void</span> *lock; } arg = { lock };
00178         rtai_lxrt(FUN_USI_LXRT_INDX, SIZARG, _SPIN_LOCK_IRQ, &amp;arg);
00179 }
00180  
00181 RTAI_PROTO(<span class="keywordtype">void</span>, rt_spin_unlock_irq,(<span class="keywordtype">void</span> *lock))
00182 {
00183         <span class="keyword">struct </span>{ <span class="keywordtype">void</span> *lock; } arg = { lock };
00184         rtai_lxrt(FUN_USI_LXRT_INDX, SIZARG, _SPIN_UNLOCK_IRQ, &amp;arg);
00185 }
00186  
00187 RTAI_PROTO(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>, rt_spin_lock_irqsave,(<span class="keywordtype">void</span> *lock))
00188 {
00189         <span class="keyword">struct </span>{ <span class="keywordtype">void</span> *lock; } arg = { lock };
00190         <span class="keywordflow">return</span> rtai_lxrt(FUN_USI_LXRT_INDX, SIZARG, _SPIN_LOCK_IRQSV, &amp;arg).i[LOW];
00191 }
00192  
00193 RTAI_PROTO(<span class="keywordtype">void</span>, rt_spin_unlock_irqrestore,(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> flags, <span class="keywordtype">void</span> *lock))
00194 {
00195         <span class="keyword">struct </span>{ <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> flags; <span class="keywordtype">void</span> *lock; } arg = { flags, lock };
00196         rtai_lxrt(FUN_USI_LXRT_INDX, SIZARG, _SPIN_UNLOCK_IRQRST, &amp;arg);
00197 }
00198  
00199 
00200 RTAI_PROTO(<span class="keywordtype">void</span>, rt_global_cli,(<span class="keywordtype">void</span>))
00201 {
00202         <span class="keyword">struct </span>{ <span class="keywordtype">int</span> dummy; } arg = { 0 };
00203         rtai_lxrt(FUN_USI_LXRT_INDX, SIZARG, _GLB_CLI, &amp;arg);
00204 }
00205 
00206 RTAI_PROTO(<span class="keywordtype">void</span>, rt_global_sti,(<span class="keywordtype">void</span>))
00207 {
00208         <span class="keyword">struct </span>{ <span class="keywordtype">int</span> dummy; } arg = { 0 };
00209         rtai_lxrt(FUN_USI_LXRT_INDX, SIZARG, _GLB_STI, &amp;arg);
00210 }
00211 
00212 RTAI_PROTO(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>, rt_global_save_flags_and_cli,(<span class="keywordtype">void</span>))
00213 {
00214         <span class="keyword">struct </span>{ <span class="keywordtype">int</span> dummy; } arg = { 0 };
00215         <span class="keywordflow">return</span> rtai_lxrt(FUN_USI_LXRT_INDX, SIZARG, _GLB_SVFLAGS_CLI, &amp;arg).i[LOW];
00216 }
00217  
00218 RTAI_PROTO(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>, rt_global_save_flags,(<span class="keywordtype">void</span>))
00219 {
00220         <span class="keyword">struct </span>{ <span class="keywordtype">int</span> dummy; } arg = { 0 };
00221         <span class="keywordflow">return</span> rtai_lxrt(FUN_USI_LXRT_INDX, SIZARG, _GLB_SVFLAGS, &amp;arg).i[LOW];
00222 }
00223  
00224 RTAI_PROTO(<span class="keywordtype">void</span>, rt_global_restore_flags,(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> flags))
00225 {
00226         <span class="keyword">struct </span>{ <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> flags; } arg = { flags };
00227         rtai_lxrt(FUN_USI_LXRT_INDX, SIZARG, _GLB_RSTFLAGS, &amp;arg);
00228 }
00229 
00230 RTAI_PROTO(<span class="keywordtype">void</span>, hard_cli,(<span class="keywordtype">void</span>))
00231 {
00232         <span class="keyword">struct </span>{ <span class="keywordtype">int</span> dummy; } arg = { 0 };
00233         rtai_lxrt(FUN_USI_LXRT_INDX, SIZARG, _CLI, &amp;arg);
00234 }
00235 
00236 RTAI_PROTO(<span class="keywordtype">void</span>, hard_sti,(<span class="keywordtype">void</span>))
00237 {
00238         <span class="keyword">struct </span>{ <span class="keywordtype">int</span> dummy; } arg = { 0 };
00239         rtai_lxrt(FUN_USI_LXRT_INDX, SIZARG, _STI, &amp;arg);
00240 }
00241 
00242 RTAI_PROTO(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>, hard_save_flags_and_cli,(<span class="keywordtype">void</span>))
00243 {
00244         <span class="keyword">struct </span>{ <span class="keywordtype">int</span> dummy; } arg = { 0 };
00245         <span class="keywordflow">return</span> rtai_lxrt(FUN_USI_LXRT_INDX, SIZARG, _SVFLAGS_CLI, &amp;arg).i[LOW];
00246 }
00247  
00248 RTAI_PROTO(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>, hard_save_flags,(<span class="keywordtype">void</span>))
00249 {
00250         <span class="keyword">struct </span>{ <span class="keywordtype">int</span> dummy; } arg = { 0 };
00251         <span class="keywordflow">return</span> rtai_lxrt(FUN_USI_LXRT_INDX, SIZARG, _SVFLAGS, &amp;arg).i[LOW];
00252 }
00253  
00254 RTAI_PROTO(<span class="keywordtype">void</span>, hard_restore_flags,(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> flags))
00255 {
00256         <span class="keyword">struct </span>{ <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> flags; } arg = { flags };
00257         rtai_lxrt(FUN_USI_LXRT_INDX, SIZARG, _RSTFLAGS, &amp;arg);
00258 }
00259 
00260 RTAI_PROTO(<span class="keywordtype">int</span>, rt_wait_intr,(<span class="keywordtype">void</span> *sem, <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> *irq))
00261 {
00262         <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> lirq;
00263         <span class="keywordtype">int</span> retval;
00264         <span class="keyword">struct </span>{ <span class="keywordtype">void</span> *sem; <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> *lirq; <span class="keywordtype">int</span> size; } arg = { sem, &amp;lirq, <span class="keyword">sizeof</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> *) };
00265         retval = rtai_lxrt(FUN_USI_LXRT_INDX, SIZARG, _WAIT_INTR, &amp;arg).i[LOW];
00266         <span class="keywordflow">if</span> (irq) {
00267                 *irq = lirq;
00268         }
00269         <span class="keywordflow">return</span> retval;
00270 }                                                                               
00271 
00272 RTAI_PROTO(<span class="keywordtype">int</span>, rt_wait_intr_if,(<span class="keywordtype">void</span> *sem, <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> *irq))
00273 {
00274         <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> lirq;
00275         <span class="keywordtype">int</span> retval;
00276         <span class="keyword">struct </span>{ <span class="keywordtype">void</span> *sem; <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> *lirq; <span class="keywordtype">int</span> size; } arg = { sem, &amp;lirq, <span class="keyword">sizeof</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> *) };
00277         retval = rtai_lxrt(FUN_USI_LXRT_INDX, SIZARG, _WAIT_INTR_IF, &amp;arg).i[LOW];
00278         <span class="keywordflow">if</span> (irq) {
00279                 *irq = lirq;
00280         }
00281         <span class="keywordflow">return</span> retval;
00282 }                                                                               
00283 
00284 RTAI_PROTO(<span class="keywordtype">int</span>, rt_wait_intr_until,(<span class="keywordtype">void</span> *sem, RTIME until, <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> *irq))
00285 {
00286         <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> lirq;
00287         <span class="keywordtype">int</span> retval;
00288         <span class="keyword">struct </span>{ <span class="keywordtype">void</span> *sem; RTIME until; <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> *lirq; <span class="keywordtype">int</span> size; } arg = { sem, until, &amp;lirq, <span class="keyword">sizeof</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> *) };
00289         retval = rtai_lxrt(FUN_USI_LXRT_INDX, SIZARG, _WAIT_INTR_UNTIL, &amp;arg).i[LOW];
00290         <span class="keywordflow">if</span> (irq) {
00291                 *irq = lirq;
00292         }
00293         <span class="keywordflow">return</span> retval;
00294 }                                                                               
00295 
00296 RTAI_PROTO(<span class="keywordtype">int</span>, rt_wait_intr_timed,(<span class="keywordtype">void</span> *sem, RTIME delay, <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> *irq))
00297 {
00298         <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> lirq;
00299         <span class="keywordtype">int</span> retval;
00300         <span class="keyword">struct </span>{ <span class="keywordtype">void</span> *sem; RTIME delay; <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> *lirq; <span class="keywordtype">int</span> size; } arg = { sem, delay, &amp;lirq, <span class="keyword">sizeof</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> *) };
00301         retval = rtai_lxrt(FUN_USI_LXRT_INDX, SIZARG, _WAIT_INTR_TIMED, &amp;arg).i[LOW];
00302         <span class="keywordflow">if</span> (irq) {
00303                 *irq = lirq;
00304         }
00305         <span class="keywordflow">return</span> retval;
00306 }                                                                               
00307 
00308 <span class="preprocessor">#ifdef __cplusplus</span>
00309 <span class="preprocessor"></span>}
00310 <span class="preprocessor">#endif </span><span class="comment">/* __cplusplus */</span>
00311 
00312 <span class="preprocessor">#endif </span><span class="comment">/* __KERNEL__ */</span>
00313 
00314 <span class="preprocessor">#endif </span><span class="comment">/* !_RTAI_USI_H */</span>
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Fri Jun 18 18:14:31 2004 for RTAI API by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 > 
</a>1.3.4 </small></address>
</body>
</html>
